@(title: String)(content: Html)

<!DOCTYPE html>

<html>
    <head>
        <title>@title</title>
        <link rel="stylesheet" media="screen" href='@routes.Assets.at("stylesheets/main.css")'>
        <link rel="stylesheet" media="screen" href='@routes.Assets.at("stylesheets/bootstrap.css")'>

        <script type='text/javascript' src='@routes.Assets.at("javascripts/jquery-1.10.2.min.js")'></script>
        <script type='text/javascript' src='@routes.Assets.at("javascripts/handlebars-v1.1.2.js")'></script>
        <script type='text/javascript' src='@routes.Assets.at("javascripts/ember.js")'></script>
        <script type='text/javascript' src='@routes.Assets.at("javascripts/ember-data.js")'></script>
        <script type='text/javascript' src='@routes.Assets.at("javascripts/bootstrap.js")'></script>

        <script src='@routes.Assets.at("javascripts/main.js")'></script>

        <script type="text/x-handlebars">    
            <div class="navbar navbar-static-top">      
                <div class="navbar-inner">
                    <a class="brand" href="#">Connectfour Plus</a>        
                    <form class="navbar-form pull-left">
                        {{input type="text" value=gameName placeholder="Enter Game Name" size="50" }}
                        <span>Play agains other Player {{input type="checkbox" name=pvp value=pvp checked=pvp}}</span>
                        <button class="btn" {{action newGame gameName pvp}}>New</button>
                    </form>

                </div>    
            </div>
            {{outlet}}
        </script>

        <script type="text/x-handlebars" id="games/index">    
            <div class="container">
                <h2>Play against other player !!</h2>
                <ul>
                    {{#each gameIndexController="games"}}
                    {{#if this.isPlayerVsPlayer }}
                    {{#if this.isWaitingForOpponent}}
                        <li>
                            <button class ="btn" {{action joinGame this.id view }}>
                            Join Game
                            </button>
                            {{this.id}}
                        </li>
                    {{/if}}
                    {{/if}}
                    {{else}}
                    No Games available
                    {{/each}}
                </ul>
            </div>

        </script>

        <script type="text/x-handlebars" id="games/play">    
            {{#unless  this.isPlayerVsPlayer}}
            <div class="nav nav-list pull-right">
                <button class ="btn" {{action undo view }}><i class="icon-arrow-left"></i>Undo</button>
                <button class ="btn" {{action redo view }}>Redo <i class="icon-arrow-right"></i></button>
            </div>
            {{/unless}}
            {{#if this.isPlayerVsPlayer}}
                <div class="pull-right">{{this.playerOnTurn}} needs to drop a coin</div>
            {{/if}}
            <div class="container">
                    <div class="row-fluid">
                        <button {{action "dropCoin" 0 view }} class="btn span1 offset2">Drop</button>
                        <button {{action "dropCoin" 1 view }} class="btn span1 ">Drop</button>
                        <button {{action "dropCoin" 2 view }} class="btn span1 ">Drop</button>
                        <button {{action "dropCoin" 3 view }} class="btn span1 ">Drop</button>
                        <button {{action "dropCoin" 4 view }} class="btn span1 ">Drop</button>
                        <button {{action "dropCoin" 5 view }} class="btn span1 ">Drop</button>
                        <button {{action "dropCoin" 6 view }} class="btn span1 ">Drop</button>
                    </div>
                    {{#each game_field}}
                    <div class="row-fluid gamefield">
                        <span class="span1 offset1"></span>
                        {{#each this}}
                        <span class="span1 {{this}} gametoken "></span>
                        {{/each}}

                    </div>
                    {{/each}}
            </div>
        </script>
    </head>
    <body>
    @content
        <div class="navbar navbar-static-top">      
            <div class="navbar-inner">
                        <a class="brand" href="#">Connectfour Plus</a>        
                <form class="navbar-form pull-left">
                    <input id = "gameName" type="text" placeholder="Enter Game Name" size="50" >
                    <button id = "new" class="btn">New</button>
                </form>

            </div>    
        </div>

        <div class="nav nav-list pull-right">
            <button class ="btn"><i class="icon-arrow-left"></i>Undo</button>
            <button class ="btn">Redo <i class="icon-arrow-right"></i></button>
        </div>

        <div class="container">
            <div class="row-fluid">
                <button id = "0" class="btn drop span1 offset2">Drop</button>
                <button id = "1" class="btn drop span1 ">Drop</button>
                <button id = "2" class="btn drop span1 ">Drop</button>
                <button id = "3" class="btn drop span1 ">Drop</button>
                <button id = "4" class="btn drop span1 ">Drop</button>
                <button id = "5" class="btn drop span1 ">Drop</button>
                <button id = "6" class="btn drop span1 ">Drop</button>
            </div>
            {{#each game_field}}
            <div class="row-fluid gamefield">
                <span class="span1 offset1"></span>
                {{#each this}}
                <span class="span1 {{this}} gametoken "></span>
                {{/each}}

            </div>
            {{/each}}
        </div>
    </body>


    <script type="text/javascript">

        $( "#new" ).click(function() {
            gameID = $( "#gameName" ).val();
            var game = {
                 'game': {'id': gameID }
            };

            var gameJson = JSON.stringify(game);

            $.ajax({
                url: '/api/games',
                type: 'post',
                contentType: "application/json; charset=utf-8",
                dataType: 'json',
                data: gameJson,
                failure: function(errMsg) {
                    alert(errMsg);
                }
            });
        });

        $( ".drop" ).click(function() {
            var column = $(this).attr('id');

            alert(gameID);

            var dropAPI =      "/api/games/" + gameID + "/dropcoin/" + column;
            var gameFieldAPI = "/api/games/" + gameID;

            $.getJSON( dropAPI )
            .done(function() {

              $.getJSON( gameFieldAPI )
                .done(function( data ) {
                  $.each( data.game.game_field, function( i, row ) {
                    $.each( row, function( j, cell ) {
                        console.log( "cell(" + i + "," + j + ")" + cell);
                    });
                  });
                });

            });
        });
   </script>

</html>
